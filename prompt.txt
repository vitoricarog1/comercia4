# PROMPT PARA REPLICA√á√ÉO DO SISTEMA IA-ATT

## VIS√ÉO GERAL DO PROJETO

O IA-ATT √© um sistema SaaS completo para cria√ß√£o e gerenciamento de agentes de IA conversacionais, com funcionalidades espec√≠ficas para barbearias e atendimento ao cliente. O sistema permite criar m√∫ltiplos agentes de IA, gerenciar conversas, integrar com diferentes provedores de IA e oferecer um painel administrativo completo.

## ARQUITETURA T√âCNICA

### Frontend (React + TypeScript + Vite)
- **Framework**: React 18.3.1 com TypeScript
- **Build Tool**: Vite 5.4.2
- **Styling**: Tailwind CSS 3.4.1
- **Roteamento**: React Router DOM 7.8.2
- **Anima√ß√µes**: Framer Motion 12.23.12
- **√çcones**: Heroicons 2.2.0 + Lucide React 0.344.0
- **Gr√°ficos**: Chart.js 4.5.0 + React ChartJS 2
- **Formul√°rios**: React Hook Form 7.62.0 + Yup 1.7.0
- **HTTP Client**: Axios 1.12.1
- **WebSocket**: Socket.IO Client 4.8.1

### Backend (Node.js + Express)
- **Runtime**: Node.js com ES Modules
- **Framework**: Express 5.1.0
- **Banco de Dados**: MySQL 2 (mysql2 3.14.5)
- **Autentica√ß√£o**: JWT (jsonwebtoken 9.0.2)
- **Criptografia**: bcrypt 6.0.0
- **WebSocket**: Socket.IO 4.8.1
- **Seguran√ßa**: Helmet 8.1.0, CORS 2.8.5
- **Valida√ß√£o**: Express Validator 7.2.1
- **Rate Limiting**: Express Rate Limit 8.1.0
- **Logging**: Morgan 1.10.1 + Winston 3.17.0
- **File Upload**: Multer 2.0.2
- **Cron Jobs**: Node Cron 4.2.1

### Integra√ß√µes de IA
- **OpenAI**: GPT-4, GPT-3.5-turbo, GPT-4-turbo
- **Google Gemini**: Gemini-pro, Gemini-1.5-flash
- **Hugging Face**: DialoGPT, BlenderBot

### Outras Integra√ß√µes
- **WhatsApp Business API**: Para atendimento via WhatsApp
- **Pagamentos**: Stripe 18.5.0, PayPal
- **2FA**: Speakeasy 2.0.0
- **QR Code**: qrcode 1.5.4
- **PDF**: jsPDF 3.0.2, PDFKit 0.17.2
- **Excel**: ExcelJS 4.4.0, XLSX 0.18.5

## ESTRUTURA DO BANCO DE DADOS

### Configura√ß√£o Multi-tenant
- **Banco Principal**: `ai_agents_saas_main` (usu√°rios, autentica√ß√£o)
- **Bancos por Usu√°rio**: `ai_agents_saas_user_{userId}` (dados isolados)

### Tabelas do Banco Principal (ai_agents_saas_main)

#### users
```sql
CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  role ENUM('admin', 'user', 'barbearia') DEFAULT 'user',
  is_active BOOLEAN DEFAULT true,
  email_verified BOOLEAN DEFAULT false,
  two_factor_enabled BOOLEAN DEFAULT false,
  two_factor_secret VARCHAR(255),
  last_login TIMESTAMP NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### user_sessions
```sql
CREATE TABLE user_sessions (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL,
  token_hash VARCHAR(255) NOT NULL,
  expires_at TIMESTAMP NOT NULL,
  ip_address VARCHAR(45),
  user_agent TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

#### audit_logs
```sql
CREATE TABLE audit_logs (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT,
  action VARCHAR(100) NOT NULL,
  resource VARCHAR(100),
  resource_id INT,
  ip_address VARCHAR(45),
  user_agent TEXT,
  details JSON,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);
```

### Tabelas Principais (por usu√°rio)

#### agents
```sql
CREATE TABLE agents (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  objective TEXT,
  personality ENUM('formal', 'casual', 'friendly', 'professional') DEFAULT 'professional',
  ai_provider ENUM('chatgpt', 'gemini', 'huggingface') NOT NULL,
  model VARCHAR(100) NOT NULL,
  system_prompt TEXT,
  temperature DECIMAL(3,2) DEFAULT 0.7,
  max_tokens INT DEFAULT 1000,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### conversations
```sql
CREATE TABLE conversations (
  id INT AUTO_INCREMENT PRIMARY KEY,
  agent_id INT,
  customer_name VARCHAR(255),
  customer_email VARCHAR(255),
  customer_phone VARCHAR(20),
  channel_type ENUM('whatsapp', 'telegram', 'web', 'api', 'chat') DEFAULT 'chat',
  status ENUM('active', 'resolved', 'pending', 'closed') DEFAULT 'active',
  priority INT DEFAULT 1,
  satisfaction_rating DECIMAL(2,1),
  start_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  end_time TIMESTAMP NULL,
  resolution_time INT,
  tags JSON,
  metadata JSON,
  FOREIGN KEY (agent_id) REFERENCES agents(id)
);
```

#### messages
```sql
CREATE TABLE messages (
  id INT AUTO_INCREMENT PRIMARY KEY,
  conversation_id INT NOT NULL,
  content TEXT NOT NULL,
  sender ENUM('user', 'agent') NOT NULL,
  message_type ENUM('text', 'image', 'audio', 'document', 'video') DEFAULT 'text',
  media_url VARCHAR(500),
  whatsapp_message_id VARCHAR(100),
  status ENUM('sent', 'delivered', 'read', 'failed') DEFAULT 'sent',
  response_time DECIMAL(8,2),
  metadata JSON,
  timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (conversation_id) REFERENCES conversations(id)
);
```

#### knowledge_base (RAG)
```sql
CREATE TABLE knowledge_base (
  id INT AUTO_INCREMENT PRIMARY KEY,
  title VARCHAR(255) NOT NULL,
  content TEXT NOT NULL,
  category VARCHAR(100),
  tags JSON,
  embedding JSON,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FULLTEXT(title, content)
);
```

#### whatsapp_sessions
```sql
CREATE TABLE whatsapp_sessions (
  id INT AUTO_INCREMENT PRIMARY KEY,
  phone_number VARCHAR(20) NOT NULL,
  session_data JSON,
  is_active BOOLEAN DEFAULT true,
  last_activity TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### integrations
```sql
CREATE TABLE integrations (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  type ENUM('whatsapp', 'telegram', 'stripe', 'paypal', 'email') NOT NULL,
  config JSON NOT NULL,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### agent_analytics
```sql
CREATE TABLE agent_analytics (
  id INT AUTO_INCREMENT PRIMARY KEY,
  agent_id INT NOT NULL,
  date DATE NOT NULL,
  total_conversations INT DEFAULT 0,
  total_messages INT DEFAULT 0,
  avg_response_time DECIMAL(8,2) DEFAULT 0,
  satisfaction_score DECIMAL(3,2) DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (agent_id) REFERENCES agents(id) ON DELETE CASCADE,
  UNIQUE KEY unique_agent_date (agent_id, date)
);
```

#### agendamentos (espec√≠fico para barbearia)
```sql
CREATE TABLE agendamentos (
  id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL,
  cliente VARCHAR(255) NOT NULL,
  telefone VARCHAR(20),
  email VARCHAR(255),
  data DATE NOT NULL,
  horario TIME NOT NULL,
  servico VARCHAR(255) NOT NULL,
  valor DECIMAL(10,2),
  pago BOOLEAN DEFAULT false,
  metodo_pagamento ENUM('dinheiro', 'cartao', 'pix', 'transferencia'),
  observacoes TEXT,
  status ENUM('agendado', 'confirmado', 'em_andamento', 'concluido', 'cancelado') DEFAULT 'agendado',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### servicos (espec√≠fico para barbearia)
```sql
CREATE TABLE servicos (
  id INT AUTO_INCREMENT PRIMARY KEY,
  nome VARCHAR(255) NOT NULL,
  descricao TEXT,
  preco DECIMAL(10,2) NOT NULL,
  duracao INT NOT NULL COMMENT 'Dura√ß√£o em minutos',
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

## M√ìDULOS E FUNCIONALIDADES

### 1. Sistema de Autentica√ß√£o
- **Login/Registro**: JWT com bcrypt
- **2FA**: Autentica√ß√£o de dois fatores com QR Code
- **Auditoria**: Log de todas as a√ß√µes do usu√°rio
- **Seguran√ßa**: Rate limiting, detec√ß√£o de intrus√£o
- **Roles**: admin, user, barbearia

### 2. Dashboard Principal
- **M√©tricas**: Total de agentes, conversas ativas, tempo de resposta
- **Gr√°ficos**: Conversas di√°rias, novos agentes, satisfa√ß√£o
- **Agentes Ativos**: Lista com status em tempo real
- **Conversas Recentes**: √öltimas intera√ß√µes

### 3. Gerenciamento de Agentes
- **CRUD Completo**: Criar, editar, deletar agentes
- **Configura√ß√µes**: Nome, descri√ß√£o, objetivo, personalidade
- **IA**: Provedor (OpenAI/Gemini/HuggingFace), modelo, temperatura
- **Prompt**: System prompt customiz√°vel
- **Status**: Ativar/desativar agentes
- **Estat√≠sticas**: Conversas, satisfa√ß√£o, tempo de resposta

### 4. Sistema de Chat
- **Interface**: Chat em tempo real com WebSocket
- **RAG**: Busca na base de conhecimento
- **M√∫ltiplos Agentes**: Sele√ß√£o de agente por conversa
- **Hist√≥rico**: Persist√™ncia de mensagens
- **Tipos de M√≠dia**: Texto, imagem, √°udio, documento

### 5. M√≥dulo Barbearia (Espec√≠fico)
- **Agendamentos**: CRUD completo com calend√°rio
- **Clientes**: Gest√£o de dados dos clientes
- **Servi√ßos**: Cat√°logo com pre√ßos
- **Pagamentos**: Controle financeiro
- **Chat Integrado**: Agente espec√≠fico para barbearia
- **Relat√≥rios**: Faturamento, agendamentos

### 6. Painel Administrativo
- **Usu√°rios**: Gest√£o completa de usu√°rios
- **Sistema**: M√©tricas de performance
- **Auditoria**: Logs de seguran√ßa
- **Alertas**: Monitoramento em tempo real
- **Backup**: Sistema automatizado

### 7. Integra√ß√µes
- **WhatsApp Business**: API oficial
- **Pagamentos**: Stripe, PayPal, PIX
- **Notifica√ß√µes**: Email, SMS, Push
- **Analytics**: M√©tricas avan√ßadas
- **Backup**: Autom√°tico e manual

## CONFIGURA√á√ÉO DO AMBIENTE

### Vari√°veis de Ambiente (.env)
```env
# Database
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=
DB_NAME=ai_agents_saas_main

# JWT
JWT_SECRET=your_jwt_secret_key

# Server
PORT=3001
NODE_ENV=development

# AI Providers
OPENAI_API_KEY=sk-your-openai-key
GOOGLE_GEMINI_API_KEY=your-gemini-key
HUGGINGFACE_API_KEY=your-huggingface-key

# WhatsApp
WHATSAPP_ACCESS_TOKEN=your-whatsapp-token
WHATSAPP_PHONE_NUMBER_ID=your-phone-id
WHATSAPP_WEBHOOK_VERIFY_TOKEN=your-verify-token

# Security
SESSION_SECRET=your-session-secret
ENCRYPTION_KEY=your-32-char-encryption-key

# Payments
STRIPE_SECRET_KEY=sk_test_your_stripe_key
PAYPAL_CLIENT_ID=your-paypal-client-id
```

## INSTALA√á√ÉO E CONFIGURA√á√ÉO

### 1. Pr√©-requisitos
- Node.js 18+
- MySQL 8.0+
- XAMPP (opcional para desenvolvimento)

### 2. Instala√ß√£o
```bash
# Clone o projeto
git clone <repository-url>
cd ia-att

# Instalar depend√™ncias
npm install

# Configurar banco de dados
npm run setup-db

# Iniciar desenvolvimento
npm run dev      # Frontend (porta 5173)
npm run server:dev  # Backend (porta 3001)
```

### 3. Configura√ß√£o do Banco
```bash
# Executar setup do banco
node server/setup-database.js

# Criar usu√°rio admin
node create-admin.js

# Configurar tabelas da barbearia
node server/setup-barbearia-tables.js
```

## ESTRUTURA DE ARQUIVOS

```
ia-att/
‚îú‚îÄ‚îÄ src/                    # Frontend React
‚îÇ   ‚îú‚îÄ‚îÄ components/         # Componentes reutiliz√°veis
‚îÇ   ‚îú‚îÄ‚îÄ pages/             # P√°ginas principais
‚îÇ   ‚îú‚îÄ‚îÄ contexts/          # Context API
‚îÇ   ‚îú‚îÄ‚îÄ services/          # Servi√ßos (API, IA)
‚îÇ   ‚îú‚îÄ‚îÄ hooks/             # Custom hooks
‚îÇ   ‚îî‚îÄ‚îÄ types/             # TypeScript types
‚îú‚îÄ‚îÄ server/                # Backend Node.js
‚îÇ   ‚îú‚îÄ‚îÄ controllers/       # L√≥gica de neg√≥cio
‚îÇ   ‚îú‚îÄ‚îÄ models/           # Modelos de dados
‚îÇ   ‚îú‚îÄ‚îÄ routes/           # Rotas da API
‚îÇ   ‚îú‚îÄ‚îÄ middleware/       # Middlewares
‚îÇ   ‚îú‚îÄ‚îÄ services/         # Servi√ßos (IA, integra√ß√£o)
‚îÇ   ‚îú‚îÄ‚îÄ config/           # Configura√ß√µes
‚îÇ   ‚îî‚îÄ‚îÄ handlers/         # WebSocket handlers
‚îú‚îÄ‚îÄ public/               # Arquivos est√°ticos
‚îî‚îÄ‚îÄ dist/                 # Build de produ√ß√£o
```

## FUNCIONALIDADES IMPLEMENTADAS

‚úÖ **Sistema de Autentica√ß√£o Completo**
- Login/Registro com JWT
- 2FA com QR Code
- Auditoria de a√ß√µes
- Rate limiting e seguran√ßa

‚úÖ **Gerenciamento de Agentes IA**
- CRUD completo
- M√∫ltiplos provedores (OpenAI, Gemini, HuggingFace)
- Configura√ß√£o de personalidade e prompts
- Estat√≠sticas detalhadas

‚úÖ **Sistema de Chat em Tempo Real**
- WebSocket para comunica√ß√£o
- RAG (Retrieval Augmented Generation)
- Hist√≥rico de conversas
- M√∫ltiplos tipos de m√≠dia

‚úÖ **M√≥dulo Barbearia Especializado**
- Sistema de agendamentos
- Gest√£o de clientes e servi√ßos
- Controle financeiro
- Chat integrado espec√≠fico

‚úÖ **Dashboard e Analytics**
- M√©tricas em tempo real
- Gr√°ficos interativos
- Relat√≥rios detalhados

‚úÖ **Painel Administrativo**
- Gest√£o de usu√°rios
- Monitoramento do sistema
- Logs de auditoria
- Sistema de backup

‚úÖ **Integra√ß√µes Externas**
- WhatsApp Business API
- Sistemas de pagamento
- Notifica√ß√µes por email

## FUNCIONALIDADES PENDENTES/MELHORIAS

üîÑ **Integra√ß√µes Avan√ßadas**
- Telegram Bot
- Instagram Direct
- Facebook Messenger

üîÑ **IA e Machine Learning**
- Treinamento de modelos customizados
- An√°lise de sentimentos
- Classifica√ß√£o autom√°tica de conversas



üîÑ **IA e Machine Learning**
- Treinamento de modelos customizados
- An√°lise de sentimentos
- Classifica√ß√£o autom√°tica de conversas
- Fine-tuning de modelos
- Vector embeddings para RAG

üîÑ **Escalabilidade**
- Microservi√ßos
- Redis para cache
- Load balancing
- CDN para assets est√°ticos
- Database sharding

üîÑ **Funcionalidades Avan√ßadas**
- Sistema de templates de resposta
- Agendamento de mensagens
- Campanhas de marketing automatizadas
- Relat√≥rios avan√ßados com exporta√ß√£o
- API p√∫blica para integra√ß√µes
- Webhooks personaliz√°veis
- Multi-idioma (i18n)
- Tema escuro/claro
- Mobile app (React Native)

üîÑ **Compliance e Governan√ßa**
- LGPD/GDPR compliance
- Pol√≠tica de reten√ß√£o de dados
- Anoniza√ß√£o de dados
- Auditoria avan√ßada
- Controle de acesso granular (RBAC)

üîÑ **DevOps e Infraestrutura**
- CI/CD pipelines (GitHub Actions/GitLab CI)
- Containeriza√ß√£o completa (Docker + Kubernetes)
- Infrastructure as Code (Terraform/Pulumi)
- Monitoramento avan√ßado (Prometheus + Grafana)
- Logging centralizado (ELK Stack)
- APM (Application Performance Monitoring)
- Health checks e readiness probes
- Auto-scaling horizontal e vertical

üîÑ **Qualidade e Testes**
- Testes unit√°rios (Jest/Vitest)
- Testes de integra√ß√£o
- Testes E2E (Playwright/Cypress)
- Code coverage reports
- An√°lise est√°tica de c√≥digo (ESLint, SonarQube)
- Testes de performance (K6/Artillery)
- Testes de seguran√ßa (OWASP ZAP)

üîÑ **Experi√™ncia do Desenvolvedor**
- Hot reload avan√ßado
- Debugging remoto
- Documenta√ß√£o interativa (Storybook)
- API documentation (Swagger/OpenAPI)
- Code generation
- Pre-commit hooks
- Conventional commits

üîÑ **Funcionalidades de Neg√≥cio Avan√ßadas**
- Sistema de assinaturas/planos
- Marketplace de agentes
- Sistema de afiliados
- Gamifica√ß√£o
- A/B testing framework
- Feature flags
- Personaliza√ß√£o avan√ßada de UI
- Workflow automation
- Integration marketplace

üîÑ **Tecnologias Emergentes**
- Edge computing
- WebAssembly para processamento pesado
- GraphQL subscriptions
- Server-Sent Events (SSE)
- Progressive Web App (PWA)
- Web Workers para processamento background
- IndexedDB para cache offline
- WebRTC para chamadas de voz/v√≠deo

üîÑ **Data & Analytics Avan√ßados**
- Data warehouse (BigQuery/Snowflake)
- ETL/ELT pipelines
- Real-time streaming (Apache Kafka)
- Machine Learning pipelines
- Data lake architecture
- Business Intelligence dashboards
- Predictive analytics
- Customer behavior tracking
- Churn prediction
- Revenue forecasting
- Cohort analysis

üîÑ **Seguran√ßa Avan√ßada**
- Zero Trust Architecture
- OAuth 2.0 / OpenID Connect
- SAML integration
- Certificate pinning
- WAF (Web Application Firewall)
- DDoS protection
- Vulnerability scanning
- Penetration testing
- Security headers
- Content Security Policy (CSP)
- Rate limiting avan√ßado
- IP whitelisting/blacklisting

üîÑ **Performance e Otimiza√ß√£o**
- Database query optimization
- Connection pooling
- Lazy loading
- Code splitting
- Tree shaking
- Image optimization
- Compression (Gzip/Brotli)
- Service Workers
- Critical CSS
- Resource hints (preload, prefetch)
- Memory leak detection
- Performance budgets

## PRINCIPAIS ENDPOINTS DA API

### Autentica√ß√£o
```
POST /api/auth/register     # Registro de usu√°rio
POST /api/auth/login        # Login
POST /api/auth/logout       # Logout
POST /api/auth/refresh      # Refresh token
POST /api/auth/verify-2fa   # Verificar 2FA
GET  /api/auth/me           # Dados do usu√°rio logado
```

### Agentes
```
GET    /api/agents         # Listar agentes
POST   /api/agents         # Criar agente
GET    /api/agents/:id     # Obter agente
PUT    /api/agents/:id     # Atualizar agente
DELETE /api/agents/:id     # Deletar agente
POST   /api/agents/:id/toggle  # Ativar/desativar
```

### Chat e Conversas
```
POST /api/chat/send         # Enviar mensagem
GET  /api/chat/messages/:conversationId  # Obter mensagens
POST /api/chat/conversation # Criar conversa
GET  /api/conversations     # Listar conversas
PUT  /api/conversations/:id # Atualizar conversa
```

### WhatsApp
```
POST /api/whatsapp/send     # Enviar mensagem WhatsApp
POST /api/whatsapp/webhook  # Webhook do WhatsApp
GET  /api/whatsapp/sessions # Listar sess√µes
```

### Barbearia
```
GET    /api/barbearia/appointments     # Listar agendamentos
POST   /api/barbearia/appointments     # Criar agendamento
PUT    /api/barbearia/appointments/:id # Atualizar agendamento
DELETE /api/barbearia/appointments/:id # Cancelar agendamento
GET    /api/barbearia/services         # Listar servi√ßos
POST   /api/barbearia/services         # Criar servi√ßo
```

### Admin
```
GET    /api/admin/users        # Listar usu√°rios
PUT    /api/admin/users/:id    # Atualizar usu√°rio
DELETE /api/admin/users/:id    # Deletar usu√°rio
GET    /api/admin/analytics    # M√©tricas do sistema
GET    /api/admin/audit-logs   # Logs de auditoria
```

## COMANDOS √öTEIS

```bash
# Desenvolvimento
npm run dev          # Frontend
npm run server:dev   # Backend com nodemon

# Produ√ß√£o
npm run build        # Build do frontend
npm run start        # Produ√ß√£o completa

# Banco de dados
npm run setup-db     # Configurar banco

# Utilit√°rios
node create-admin.js              # Criar admin
node check-all-users.js           # Listar usu√°rios
node server/setup-barbearia-tables.js  # Setup barbearia
```

## SEGURAN√áA

- **Autentica√ß√£o**: JWT com refresh tokens
- **Criptografia**: bcrypt para senhas, AES para dados sens√≠veis
- **Rate Limiting**: Prote√ß√£o contra ataques
- **CORS**: Configurado para dom√≠nios espec√≠ficos
- **Helmet**: Headers de seguran√ßa
- **Valida√ß√£o**: Sanitiza√ß√£o de inputs
- **Auditoria**: Log de todas as a√ß√µes

## PERFORMANCE

- **Frontend**: Lazy loading de componentes
- **Backend**: Connection pooling MySQL
- **Cache**: Implementa√ß√£o b√°sica (expandir com Redis)
- **Compress√£o**: Gzip habilitado
- **Otimiza√ß√£o**: Bundle splitting no Vite

## MONITORAMENTO

- **Logs**: Winston para logging estruturado
- **M√©tricas**: Dashboard de sistema
- **Alertas**: Notifica√ß√µes autom√°ticas
- **Health Check**: Endpoint `/api/health`

## DEPLOYMENT

### Desenvolvimento Local
1. XAMPP para MySQL
2. Node.js 18+
3. Configurar .env
4. `npm install && npm run setup-db`
5. `npm run dev` + `npm run server:dev`

### Produ√ß√£o
1. VPS/Cloud com Node.js e MySQL
2. Configurar vari√°veis de ambiente
3. `npm run build`
4. PM2 para gerenciamento de processos
5. Nginx como proxy reverso
6. SSL/TLS com Let's Encrypt

### Docker (Opcional)
```dockerfile
# Dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
RUN npm run build
EXPOSE 3001
CMD ["npm", "start"]
```

```yaml
# docker-compose.yml
version: '3.8'
services:
  app:
    build: .
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=production
      - DB_HOST=mysql
    depends_on:
      - mysql
      - redis
  
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword
      MYSQL_DATABASE: ai_agents_saas_main
    volumes:
      - mysql_data:/var/lib/mysql
  
  redis:
    image: redis:alpine
    volumes:
      - redis_data:/data
  
  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/ssl
    depends_on:
      - app

volumes:
  mysql_data:
  redis_data:
```

### Configura√ß√£o PM2
```json
{
  "name": "ia-att",
  "script": "server/app.js",
  "instances": "max",
  "exec_mode": "cluster",
  "env": {
    "NODE_ENV": "production",
    "PORT": 3001
  },
  "log_file": "./logs/combined.log",
  "out_file": "./logs/out.log",
  "error_file": "./logs/error.log",
  "log_date_format": "YYYY-MM-DD HH:mm Z"
}
```

### Nginx Configuration
```nginx
server {
    listen 80;
    server_name yourdomain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name yourdomain.com;
    
    ssl_certificate /etc/ssl/cert.pem;
    ssl_certificate_key /etc/ssl/key.pem;
    
    location / {
        root /var/www/html/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    location /socket.io {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

## TROUBLESHOOTING E PROBLEMAS COMUNS

### Problemas de Instala√ß√£o
```bash
# Erro de permiss√µes no Windows
npm config set fund false
npm config set audit-level moderate

# Limpar cache do npm
npm cache clean --force

# Reinstalar node_modules
rm -rf node_modules package-lock.json
npm install
```

### Problemas de Banco de Dados
```sql
-- Verificar conex√£o MySQL
SHOW DATABASES;

-- Verificar usu√°rios
SELECT User, Host FROM mysql.user;

-- Criar usu√°rio se necess√°rio
CREATE USER 'iaatt'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON *.* TO 'iaatt'@'localhost';
FLUSH PRIVILEGES;
```

### Problemas de API Keys
- Verificar se as chaves est√£o corretas no .env
- Testar conex√£o com cada provedor de IA
- Verificar limites de rate limiting
- Confirmar saldo/cr√©ditos nas contas

### Problemas de WebSocket
- Verificar se a porta 3001 est√° liberada
- Confirmar configura√ß√£o de CORS
- Testar conex√£o Socket.IO no navegador

### Logs Importantes
```bash
# Logs do servidor
tail -f server/logs/error.log
tail -f server/logs/combined.log

# Logs do PM2
pm2 logs ia-att

# Logs do sistema
journalctl -u nginx -f
```

## BACKUP E RECUPERA√á√ÉO

### Backup Autom√°tico
```bash
# Script de backup di√°rio
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/backups"

# Backup do banco de dados
mysqldump -u root -p ai_agents_saas_main > $BACKUP_DIR/db_main_$DATE.sql

# Backup dos bancos de usu√°rios
for db in $(mysql -u root -p -e "SHOW DATABASES LIKE 'ai_agents_saas_user_%';" | grep ai_agents_saas_user_); do
    mysqldump -u root -p $db > $BACKUP_DIR/db_${db}_$DATE.sql
done

# Backup dos arquivos
tar -czf $BACKUP_DIR/files_$DATE.tar.gz /path/to/ia-att

# Limpar backups antigos (manter 30 dias)
find $BACKUP_DIR -name "*.sql" -mtime +30 -delete
find $BACKUP_DIR -name "*.tar.gz" -mtime +30 -delete
```

### Recupera√ß√£o
```bash
# Restaurar banco principal
mysql -u root -p ai_agents_saas_main < backup_file.sql

# Restaurar banco de usu√°rio
mysql -u root -p ai_agents_saas_user_123 < user_backup.sql

# Restaurar arquivos
tar -xzf files_backup.tar.gz -C /
```

## MONITORAMENTO E ALERTAS

### M√©tricas Importantes
- CPU e mem√≥ria do servidor
- Conex√µes ativas do banco de dados
- Tempo de resposta das APIs
- Taxa de erro das requisi√ß√µes
- Uso de storage
- N√∫mero de usu√°rios ativos

### Alertas Configurados
- Falha na conex√£o com banco de dados
- APIs de IA indispon√≠veis
- Uso de CPU > 80%
- Uso de mem√≥ria > 85%
- Disk space < 10%
- Erro rate > 5%

## CONSIDERA√á√ïES FINAIS

Este sistema √© uma plataforma SaaS completa e robusta para cria√ß√£o e gerenciamento de agentes de IA conversacionais. A arquitetura modular permite f√°cil extens√£o e customiza√ß√£o para diferentes casos de uso, como o m√≥dulo espec√≠fico para barbearias j√° implementado.

O sistema est√° pronto para produ√ß√£o com todas as funcionalidades de seguran√ßa, monitoramento e escalabilidade b√°sicas implementadas. Para crescimento futuro, recomenda-se a implementa√ß√£o de microservi√ßos, cache distribu√≠do e otimiza√ß√µes de performance adicionais.

### Pr√≥ximos Passos Recomendados
1. **Implementar Redis** para cache e sess√µes
2. **Configurar CDN** para assets est√°ticos
3. **Implementar rate limiting** mais granular
4. **Adicionar testes automatizados** (Jest, Cypress)
5. **Configurar CI/CD** (GitHub Actions, GitLab CI)
6. **Implementar monitoramento** (Prometheus, Grafana)
7. **Adicionar documenta√ß√£o da API** (Swagger/OpenAPI)
8. **Implementar versionamento da API**
9. **Configurar ambiente de staging**
10. **Implementar feature flags**